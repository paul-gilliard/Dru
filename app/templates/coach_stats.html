{% extends 'base.html' %}
{% block title %}Suivi statistiques{% endblock %}
{% block content %}
<h2>Suivi statistiques</h2>

<!-- {% include 'coach_nav.html' %} -->

<div class="card">
  <h3>Sélection athlete</h3>
  <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
    <select id="stats-athlete-select">
      <option value="">— choisir un athlete —</option>
      {% for a in athletes %}
      <option value="{{ a.id }}">{{ a.username }}</option>
      {% endfor %}
    </select>

    <label style="display:flex; align-items:center; gap:8px; margin-left:12px;">
      <input id="toggle-kcals" type="checkbox" checked> Kcals
    </label>
    <label style="display:flex; align-items:center; gap:8px;">
      <input id="toggle-water" type="checkbox" checked> Eau
    </label>
    <label style="display:flex; align-items:center; gap:8px;">
      <input id="toggle-sleep" type="checkbox"> Sommeil
    </label>
  </div>
</div>

<div class="card" style="margin-top:12px;">
  <h3>Récapitulatif 7 derniers jours</h3>
  <div id="summary-7days-container" style="display:none;">
    <table style="width:100%; border-collapse:collapse;">
      <tbody>
        <tr style="border-bottom: 1px solid #e5e7eb;">
          <td style="padding:12px; font-weight:600;">Poids</td>
          <td style="padding:12px; text-align:center;"><span id="summary-weight">—</span></td>
        </tr>
        <tr style="border-bottom: 1px solid #e5e7eb;">
          <td style="padding:12px; font-weight:600;">Kcals (moy.)</td>
          <td style="padding:12px; text-align:center;"><span id="summary-kcals">—</span></td>
        </tr>
        <tr style="border-bottom: 1px solid #e5e7eb;">
          <td style="padding:12px; font-weight:600;">Eau (moy.)</td>
          <td style="padding:12px; text-align:center;"><span id="summary-water">—</span></td>
        </tr>
        <tr style="border-bottom: 1px solid #e5e7eb;">
          <td style="padding:12px; font-weight:600;">Sommeil (moy.)</td>
          <td style="padding:12px; text-align:center;"><span id="summary-sleep">—</span></td>
        </tr>
        <tbody id="summary-tonnage-body"></tbody>
      </tbody>
    </table>
  </div>
</div>

<div class="card" style="margin-top:12px;">
  <h3>Poids & journaux</h3>
  <canvas id="chart-journal" height="160"></canvas>
</div>

<div class="card" style="margin-top:12px;">
  <h3>Tonnage par groupe musculaire</h3>
  <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
    <select id="stats-muscle-select">
      <option value="">— choisir un groupe musculaire —</option>
    </select>
    <button id="clear-muscle" type="button" class="secondary">Effacer</button>
  </div>
  
  <!-- Tonnage Chart -->
  <div id="tonnage-chart-container" style="display:none;">
    <canvas id="chart-tonnage" height="100"></canvas>
  </div>
</div>

<div class="card" style="margin-top:12px;">
  <h3>Performances par exercice</h3>
  <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
    <select id="stats-exercise-select">
      <option value="">— choisir un exercice —</option>
    </select>
    <button id="clear-exercise" type="button" class="secondary">Effacer</button>
  </div>
  
  <!-- Performance Chart by Date -->
  <div id="perf-chart-container" style="display:none; margin-bottom:20px;">
    <h4 style="color: #0b63d6; margin-bottom: 12px;">Évolution de la performance</h4>
    <canvas id="chart-performance" height="100"></canvas>
  </div>

  <!-- Main Series Table -->
  <div id="main-series-container" style="display:none; margin-bottom:20px;">
    <h4 style="color: #0b63d6; margin-bottom: 12px;">Séries principales</h4>
    <table id="main-series-table" style="width:100%; border-collapse:collapse;">
      <thead>
        <tr style="background: #f3f4f6; border-bottom: 2px solid #d1d5db;">
          <th style="padding:12px; text-align:left; font-weight:600;">Date</th>
          <th style="padding:12px; text-align:center; font-weight:600;">Reps</th>
          <th style="padding:12px; text-align:center; font-weight:600;">Poids (kg)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  
  <!-- Other Series Chart -->
  <div id="other-series-chart-container" style="display:none; margin-bottom:20px;">
    <h4 style="color: #0b63d6; margin-bottom: 12px;">Autres séries - Évolution</h4>
    <canvas id="chart-other-series" height="100"></canvas>
  </div>
  
  <!-- Other Series Table -->
  <div id="other-series-container" style="display:none;">
    <h4 style="color: #0b63d6; margin-bottom: 12px;">Autres séries (moyennes)</h4>
    <table id="other-series-table" style="width:100%; border-collapse:collapse;">
      <thead>
        <tr style="background: #f3f4f6; border-bottom: 2px solid #d1d5db;">
          <th style="padding:12px; text-align:left; font-weight:600;">Date</th>
          <th style="padding:12px; text-align:center; font-weight:600;">Reps (moy.)</th>
          <th style="padding:12px; text-align:center; font-weight:600;">Poids moy. (kg)</th>
          <th style="padding:12px; text-align:center; font-weight:600;">Nombre</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/coach_stats.js') }}"></script>
{% endblock %}